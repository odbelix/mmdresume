{# extends 'base.html.twig' #}
{% extends "ResumeBundle:Default:panel-backend.html.twig" %}

{% block csspage %}
<link href="{{asset('css/bootstrap-datepicker3.css')}}" rel="stylesheet" type="text/css">
{% endblock%}

{% block maincontent %}
<div class="row">
    <div class="col-lg-12">
    <h1 class="page-header">Trabajos</h1>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
  <div class="col-lg-12">
      <div class="panel panel-default">
        <div class="panel-heading">Lista de <b>Trabajos</b> creados en la Plataforma
        </div>
        <div class="panel-body">
        {% for flash_message in app.session.flashBag.get('notice') %}
        <div class="row">
            <div class="col-lg-12">
            <div class="alert alert-success alert-dismissable">
                                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                                {{ flash_message }}
                            </div>

            </div>
        </div>
        {% endfor %}


        {% for flash_message in app.session.flashBag.get('error') %}
        <div class="row">
            <div class="col-lg-12">
            <div class="alert alert-danger alert-dismissable">
                                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                                {{ flash_message }}
                            </div>

            </div>
        </div>
        {% endfor %}


          <div class="row">
            <div class="col-lg-6">
            <!-- NEWJOB MODAL -->

            <!-- MODAL -->
              <div class="modal fade" id="myModalNewJobTeacher" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
              <div class="modal-dialog">
                      <div class="modal-content">
                               <div class="modal-header">
                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                             <h4 class="modal-title" id="myModalLabel">Nuevo Trabajo para Docente</h4>
                                </div>
                                {{ form_start(formteacher) }}
                                <div class="modal-body">
                                         <!-- FORM FOR NEW JOB -->
                                         {{ form_widget(formteacher) }}
                                         <!-- FORM FOR NEW JOB -->
                                 </div>
                                 <div class="modal-footer">
                                     <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                     <button type="submit" class="btn btn-primary">Crear</button>
                                  </div>
                                  {{ form_end(formteacher) }}
                             </div>
                             <!-- /.modal-content -->
                     </div>
                     <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- MODAL -->

            <!-- MODAL -->
              <div class="modal fade" id="myModalNewJobTechtop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
              <div class="modal-dialog">
                      <div class="modal-content">
                               <div class="modal-header">
                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                             <h4 class="modal-title" id="myModalLabel">Nuevo Trabajo para Técnico de Nivel Superior</h4>
                                </div>
                                {{ form_start(formtechtop) }}
                                <div class="modal-body">
                                         <!-- FORM FOR NEW JOB -->
                                         {{ form_widget(formtechtop) }}
                                         <!-- FORM FOR NEW JOB -->
                                 </div>
                                 <div class="modal-footer">
                                     <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                     <button type="submit" class="btn btn-primary">Crear</button>
                                  </div>
                                  {{ form_end(formtechtop) }}
                             </div>
                             <!-- /.modal-content -->
                     </div>
                     <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- MODAL -->

            <!-- MODAL -->
              <div class="modal fade" id="myModalNewJobTechmid" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
              <div class="modal-dialog">
                      <div class="modal-content">
                               <div class="modal-header">
                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                             <h4 class="modal-title" id="myModalLabel">Nuevo Trabajo para Técnico de Nivel Medio</h4>
                                </div>
                                {{ form_start(formtechmid) }}
                                <div class="modal-body">
                                         <!-- FORM FOR NEW JOB -->
                                         {{ form_widget(formtechmid) }}
                                         <!-- FORM FOR NEW JOB -->
                                 </div>
                                 <div class="modal-footer">
                                     <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                     <button type="submit" class="btn btn-primary">Crear</button>
                                  </div>
                                  {{ form_end(formtechmid) }}
                             </div>
                             <!-- /.modal-content -->
                     </div>
                     <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- MODAL -->

            <!-- MODAL -->
              <div class="modal fade" id="myModalNewJobSchool" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
              <div class="modal-dialog">
                      <div class="modal-content">
                               <div class="modal-header">
                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                             <h4 class="modal-title" id="myModalLabel">Nuevo Trabajo para Asistente Educación</h4>
                                             <h6 class="modal-title">Enseñanza media finalizada</h6>
                                </div>
                                {{ form_start(formschool, {'name': 'form'}) }}
                                <div class="modal-body">
                                         <!-- FORM FOR NEW JOB -->
                                         {{ form_widget(formschool) }}
                                         <!-- FORM FOR NEW JOB -->
                                 </div>
                                 <div class="modal-footer">
                                     <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                     <button type="submit" class="btn btn-primary">Crear</button>
                                  </div>
                                  {{ form_end(formschool) }}
                             </div>
                             <!-- /.modal-content -->
                     </div>
                     <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- MODAL -->


            <!-- MODAL -->
              <div class="modal fade" id="myModalNewJobProfessional" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
              <div class="modal-dialog">
                      <div class="modal-content">
                               <div class="modal-header">
                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                             <h4 class="modal-title" id="myModalLabel">Nuevo Trabajo para Profesional</h4>
                                </div>
                                {{ form_start(formprofessional) }}
                                <div class="modal-body">
                                         <!-- FORM FOR NEW JOB -->
                                         {{ form_widget(formprofessional) }}
                                         <!-- FORM FOR NEW JOB -->
                                 </div>
                                 <div class="modal-footer">
                                     <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                     <button type="submit" class="btn btn-primary">Crear</button>
                                  </div>
                                  {{ form_end(formprofessional) }}
                             </div>
                             <!-- /.modal-content -->
                     </div>
                     <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <!-- MODAL -->


            <!-- NEWJOB MODAL -->
            </div>
            <div class="col-lg-3">
              <select name="usertype" id="usertype" class="form-control">
              <option value="0">Seleccionar tipo de Postulante</option>
              {% for data in usertypes %}
                <option value="{{data.id}}">{{data.name}}</option>
              {% endfor %}
              </select>
            </div>
            <div class="col-lg-3">
              <div class="text-right">
                <button name="newbutton" id="newbutton" disabled class="btn form-control" data-toggle="modal" data-target="#myModalNewJob">
                  Nuevo Trabajo
                </button>
              </div>
            </div>
          </div>
          <hr>
            {% include "ResumeBundle:Utils:search-table-searchbar.html.twig" %}
            <table class="table table-striped table-hover results">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Nombre</th>
                        <th>Inicio</th>
                        <th>Termino</th>
                        <th>Tipo</th>
                        <th>Establecimiento</th>
                        <th>Opciones</th>
                    </tr>
                    {% set columns = 6 %}
                    {% include "ResumeBundle:Utils:search-table-trresult.html.twig" %}
                </thead>
                <tbody>
                {% set count = 1 %}
                {% for job in jobs %}
                    <tr>
                        <td><a href="{{ path('panel_job_show', { 'id': job.id }) }}">{{ count }}</a></td>
                        <td>{{ job.name }}</td>
                        <td>{% if job.startjob %}{{ job.startjob|date('Y-m-d') }}{% endif %}</td>
                        <td>{% if job.endjob %}{{ job.endjob|date('Y-m-d') }}{% endif %}</td>
                        {% if job.profession is not null %}
                          <td>{{ job.profession.usertype }}</td>
                        {% else %}
                          <td>Enseñanza Media</td>
                        {% endif %}
                        <td>{{ job.workplace }}</td>
                        <td>
                        <!-- <td class="btn-group-wrap">
                          <div class="btn-group button-in-table" role="group" aria-label="..."> -->
                            <a class="btn btn-default" href="{{ path('panel_job_show', { 'id': job.id }) }}">Ver</a>
                            <a class="btn btn-default" href="{{ path('panel_job_edit', { 'id': job.id }) }}">Editar</a>
                          <!-- </div> -->
                        </td>
                    </tr>
                    {% set count = count + 1 %}
                {% endfor %}
                </tbody>
            </table>
        </div>
      </div>
   </div>
</div>
{% endblock %}

{% block scriptpage %}
<script src="{{asset('js/bootstrap-datepicker.js')}}"></script>
<script src="{{asset('js/bootstrap-datepicker.es.min.js')}}"></script>
<script src="{{asset('js/search-bar-tables.js')}}"></script>
<script type="text/javascript">
$( "#usertype" ).change(function() {
  if ( $(this).val() != 0 ){
    $( "#newbutton" ).prop('disabled', false);
    $( "#newbutton" ).addClass('btn-primary');
  }
  else {
    $( "#newbutton" ).prop('disabled', true);
    $( "#newbutton" ).removeClass('btn-primary');
  }

  switch($(this).val()){
    case "1":
      $( "#newbutton" ).attr("data-target","#myModalNewJobTeacher");
      break;
    case "2":
      $( "#newbutton" ).attr("data-target","#myModalNewJobTechtop");
      break;
    case "3":
      $( "#newbutton" ).attr("data-target","#myModalNewJobTechmid");
      break;
    case "4":
      $( "#newbutton" ).attr("data-target","#myModalNewJobSchool");
      break;
    case "5":
      $( "#newbutton" ).attr("data-target","#myModalNewJobProfessional");
      break;
  }

});

$(function () {
  $('#job_startjob').datepicker({
    language: 'es'
  });
  $('#job_endjob').datepicker({
    language: 'es'
  });
});

</script>
{% endblock %}
